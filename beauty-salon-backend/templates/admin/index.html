{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'admin/beauty_dashboard.css' %}">
{% endblock %}

{% block content %}
<div id="content-main" role="main">
<div class="beauty-dashboard">

    <div class="dashboard-header">
        <div class="dashboard-title-wrap">
            <h1>{% trans "Panel Zarządzania Salonem" %}</h1>
            <p class="dashboard-subtitle">
                {% now "l, j F Y" %} &nbsp;|&nbsp;
                {% trans "Zalogowany jako:" %}
                <strong>{{ user.get_full_name|default:user.email }}</strong>
            </p>
        </div>
        <div class="dashboard-pill">
            <span class="dashboard-pill-dot"></span>
            <span>{% trans "Salon online i gotowy na wizyty" %}</span>
        </div>
    </div>

    <div class="quick-actions-grid">
        <a href="{% url 'admin:beauty_salon_appointment_add' %}" class="quick-action-card"
           aria-label="{% trans 'Dodaj nową wizytę' %}" style="--quick-action-color: var(--beauty-accent-soft);">
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <div class="quick-action-content">
                <strong>{% trans 'Dodaj wizytę' %}</strong>
                <span>{% trans 'Rezerwacja terminu dla klienta.' %}</span>
            </div>
        </a>
        <a href="{% url 'admin:beauty_salon_client_add' %}" class="quick-action-card"
           aria-label="{% trans 'Dodaj nowego klienta' %}" style="--quick-action-color: var(--dashboard-info-bg);">
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
            </svg>
            <div class="quick-action-content">
                <strong>{% trans 'Dodaj klienta' %}</strong>
                <span>{% trans 'Rejestracja nowego użytkownika.' %}</span>
            </div>
        </a>
        <a href="{% url 'admin:beauty_salon_employee_add' %}" class="quick-action-card"
           aria-label="{% trans 'Dodaj nowego pracownika' %}" style="--quick-action-color: var(--dashboard-success-bg);">
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0h4m-4 0v11m0 0h4m-4 0v-4" />
            </svg>
            <div class="quick-action-content">
                <strong>{% trans 'Dodaj pracownika' %}</strong>
                <span>{% trans 'Nowy ekspert do zespołu.' %}</span>
            </div>
        </a>
        <a href="{% url 'admin:beauty_salon_service_add' %}" class="quick-action-card"
           aria-label="{% trans 'Dodaj nową usługę' %}" style="--quick-action-color: var(--dashboard-warning-bg);">
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            <div class="quick-action-content">
                <strong>{% trans 'Dodaj usługę' %}</strong>
                <span>{% trans 'Nowa pozycja w cenniku.' %}</span>
            </div>
        </a>
    </div>

    <div class="section-heading">
        {% trans "SALON I FINANSE" %}
        <small>{% trans "Przetworzone dane na dzisiaj" %}</small>
    </div>

    <div class="stats-grid">
        <div class="stat-card info">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M12 20.578A6.5 6.5 0 0019.294 17H4.706a6.5 6.5 0 007.294 3.578zM18 10a2 2 0 100-4 2 2 0 000 4z"/></svg>
            </div>
            <div>
                <div class="stat-label">{% trans "AKTYWNI KLIENCI" %}</div>
                <div class="stat-value">{{ dashboard_active_clients }}</div>
                <div class="stat-meta">{% trans "Zapisani w systemie" %}</div>
            </div>
        </div>

        <div class="stat-card warning">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M12 20.578A6.5 6.5 0 0019.294 17H4.706a6.5 6.5 0 007.294 3.578zM18 10a2 2 0 100-4 2 2 0 000 4z"/></svg>
            </div>
            <div>
                <div class="stat-label">{% trans "AKTYWNI PRACOWNICY" %}</div>
                <div class="stat-value">{{ dashboard_active_employees }}</div>
                <div class="stat-meta">{% trans "Widoczni w grafiku" %}</div>
            </div>
        </div>

        <div class="stat-card success">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
            </div>
            <div>
                <div class="stat-label">{% trans "AKTYWNE USŁUGI" %}</div>
                <div class="stat-value">{{ dashboard_active_services }}</div>
                <div class="stat-meta">{% trans "Dostępne do rezerwacji" %}</div>
            </div>
        </div>

        <div class="stat-card primary">
            <div class="stat-icon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zM9 9h6m-3 3v6m0-6h-6m6 0v6m-6-6v6"/></svg>
            </div>
            <div>
                <div class="stat-label">{% trans "PRZYCHÓD (MIESIĄC)" %}</div>
                <div class="stat-value">
                    {{ dashboard_revenue_month|floatformat:2 }} PLN
                </div>
                <div class="stat-meta">{% trans "Łączny przychód tego miesiąca" %}</div>
            </div>
        </div>
    </div>


       <div class="content-grid">

        {# --- Nadchodzące wizyty --- #}
        <div class="dashboard-card" style="min-height: 300px;">
            <div class="card-header">
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                <h2>{% trans "Nadchodzące wizyty (dzisiaj i jutro)" %}</h2>
            </div>
            <div class="card-body">
                {% if dashboard_upcoming_appointments %}
                    <ul class="info-list">
                        {% for a in dashboard_upcoming_appointments %}
                            <li class="info-item">
                                <div class="info-icon-dot"></div>
                                <div>
                                    <div class="info-title">
                                        {{ a.start|date:"d.m (D) H:i" }} · {{ a.service.name }}
                                    </div>
                                    <div class="info-meta">
                                        {{ a.client.get_full_name|default:"Klient" }}
                                        · {{ a.employee.get_full_name|default:"Pracownik" }}
                                        · {{ a.get_status_display }}
                                    </div>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        {% trans "Brak nadchodzących wizyt do wyświetlenia." %}
                    </div>
                {% endif %}
            </div>
        </div>

        {# --- Oczekujące akceptacje urlopów --- #}
        <div class="dashboard-card" style="min-height: 300px;">
            <div class="card-header warning">
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
                <h2>{% trans "Oczekujące akceptacje" %}</h2>
            </div>
            <div class="card-body">
                {% if dashboard_pending_timeoffs %}
                    <ul class="info-list">
                        {% for t in dashboard_pending_timeoffs %}
                            <li class="info-item">
                                <div class="info-icon-dot warning"></div>
                                <div>
                                    <div class="info-title">
                                        {{ t.employee.get_full_name|default:"Pracownik" }}
                                    </div>
                                    <div class="info-meta">
                                        {{ t.date_from|date:"d.m.Y" }} – {{ t.date_to|date:"d.m.Y" }}
                                        · {{ t.get_type_display }}
                                        · {{ t.get_status_display }}
                                    </div>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        {% trans "Obecnie brak urlopów do rozpatrzenia." %}
                    </div>
                {% endif %}
            </div>
        </div>

    </div>
</div>
</div>
{% endblock %}