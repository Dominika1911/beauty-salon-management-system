# Generated by Django 5.0.14 on 2025-11-15 23:10

import django.core.validators
import django.db.models.deletion
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('email', models.EmailField(db_index=True, max_length=254, unique=True, verbose_name='email')),
                ('role', models.CharField(choices=[('manager', 'Manager'), ('employee', 'Employee'), ('client', 'Client')], db_index=True, default='client', max_length=20, verbose_name='role')),
                ('is_staff', models.BooleanField(default=False, verbose_name='staff status')),
                ('is_active', models.BooleanField(default=True, verbose_name='active')),
                ('last_login_ip', models.GenericIPAddressField(blank=True, null=True, verbose_name='last login IP')),
                ('failed_login_attempts', models.PositiveIntegerField(default=0, verbose_name='failed login attempts')),
                ('account_locked_until', models.DateTimeField(blank=True, null=True, verbose_name='account locked until')),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'verbose_name': 'user',
                'verbose_name_plural': 'users',
                'db_table': 'users',
            },
        ),
        migrations.CreateModel(
            name='Klient',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='usunięte (GDPR)')),
                ('imie', models.CharField(max_length=100, verbose_name='imię')),
                ('nazwisko', models.CharField(max_length=100, verbose_name='nazwisko')),
                ('email', models.EmailField(db_index=True, max_length=254, verbose_name='email')),
                ('telefon', models.CharField(blank=True, max_length=20, validators=[django.core.validators.RegexValidator('^\\+?1?\\d{9,15}$', "Numer telefonu musi być w formacie: '+999999999'. Do 15 cyfr.")], verbose_name='telefon')),
                ('nr', models.CharField(db_index=True, max_length=20, unique=True, verbose_name='numer klienta')),
                ('zgoda_marketing', models.BooleanField(default=False, verbose_name='zgoda marketingowa')),
                ('preferowany_kontakt', models.CharField(choices=[('email', 'Email'), ('telefon', 'Telefon'), ('sms', 'SMS')], default='email', max_length=20, verbose_name='preferowany kontakt')),
                ('liczba_wizyt', models.PositiveIntegerField(default=0, verbose_name='liczba wizyt')),
                ('laczna_wydana_kwota', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='łączna wydana kwota')),
                ('notatki_wewnetrzne', models.TextField(blank=True, verbose_name='notatki wewnętrzne')),
                ('user', models.OneToOneField(blank=True, limit_choices_to={'role': 'client'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='klient', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'klient',
                'verbose_name_plural': 'klienci',
                'db_table': 'klienci',
                'ordering': ['nazwisko', 'imie'],
            },
        ),
        migrations.CreateModel(
            name='LogEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('czas', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='czas')),
                ('typ', models.CharField(choices=[('rezerwacja', 'Rezerwacja wizyty'), ('zmiana_statusu', 'Zmiana statusu wizyty'), ('platnosc', 'Płatność'), ('dodanie_uslugi', 'Dodanie usługi'), ('rejestracja_klienta', 'Rejestracja klienta'), ('login', 'Logowanie'), ('zmiana_ustawien', 'Zmiana ustawień'), ('inne', 'Inne')], db_index=True, max_length=30, verbose_name='typ')),
                ('poziom', models.CharField(choices=[('info', 'Info'), ('warning', 'Ostrzeżenie'), ('error', 'Błąd'), ('critical', 'Krytyczny')], default='info', max_length=20, verbose_name='poziom')),
                ('opis', models.TextField(verbose_name='opis')),
                ('adres_ip', models.GenericIPAddressField(blank=True, null=True, verbose_name='adres IP')),
                ('user_agent', models.CharField(blank=True, max_length=500, verbose_name='user agent')),
                ('entity_type', models.CharField(blank=True, max_length=50, verbose_name='typ encji')),
                ('entity_id', models.PositiveBigIntegerField(blank=True, db_index=True, null=True, verbose_name='ID encji')),
                ('metadata', models.JSONField(blank=True, default=dict, verbose_name='metadane')),
                ('uzytkownik', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='log_entries', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'log entry',
                'verbose_name_plural': 'log entries',
                'db_table': 'logi',
                'ordering': ['-czas'],
            },
        ),
        migrations.CreateModel(
            name='Pracownik',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('nr', models.CharField(db_index=True, max_length=20, unique=True, verbose_name='numer pracownika')),
                ('imie', models.CharField(max_length=100, verbose_name='imię')),
                ('nazwisko', models.CharField(max_length=100, verbose_name='nazwisko')),
                ('telefon', models.CharField(blank=True, max_length=20, validators=[django.core.validators.RegexValidator('^\\+?1?\\d{9,15}$', "Numer telefonu musi być w formacie: '+999999999'. Do 15 cyfr.")], verbose_name='telefon')),
                ('data_zatrudnienia', models.DateField(blank=True, null=True, verbose_name='data zatrudnienia')),
                ('aktywny', models.BooleanField(db_index=True, default=True, verbose_name='aktywny')),
                ('liczba_wizyt', models.PositiveIntegerField(default=0, verbose_name='liczba wizyt')),
                ('srednia_ocena', models.DecimalField(blank=True, decimal_places=2, max_digits=3, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.0')), django.core.validators.MaxValueValidator(Decimal('5.0'))], verbose_name='średnia ocena')),
                ('user', models.OneToOneField(limit_choices_to={'role': 'employee'}, on_delete=django.db.models.deletion.CASCADE, related_name='pracownik', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'pracownik',
                'verbose_name_plural': 'pracownicy',
                'db_table': 'pracownicy',
                'ordering': ['nazwisko', 'imie'],
            },
        ),
        migrations.CreateModel(
            name='Material',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('typ', models.CharField(choices=[('portfolio', 'Portfolio'), ('usluga', 'Zdjęcie usługi'), ('inne', 'Inne')], default='portfolio', max_length=20, verbose_name='typ')),
                ('url', models.CharField(max_length=500, verbose_name='URL')),
                ('opis', models.TextField(blank=True, verbose_name='opis')),
                ('nazwa_pliku', models.CharField(blank=True, max_length=255, verbose_name='nazwa pliku')),
                ('rozmiar_bajtow', models.PositiveIntegerField(blank=True, null=True, verbose_name='rozmiar (B)')),
                ('mime_type', models.CharField(blank=True, max_length=100, verbose_name='MIME type')),
                ('aktywny', models.BooleanField(db_index=True, default=True, verbose_name='aktywny')),
                ('wlasciciel_prac', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='materialy', to='beauty_salon.pracownik')),
            ],
            options={
                'verbose_name': 'materiał',
                'verbose_name_plural': 'materiały',
                'db_table': 'materialy',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Grafik',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('okresy_dostepnosci', models.JSONField(default=list, help_text='Format: [{"day": "Monday", "start": "09:00", "end": "17:00"}]', verbose_name='okresy dostępności')),
                ('przerwy', models.JSONField(default=list, help_text='Format: [{"start": "12:00", "end": "12:30"}]', verbose_name='przerwy')),
                ('status', models.CharField(choices=[('aktywny', 'Aktywny'), ('oczekujacy', 'Oczekujący na zatwierdzenie'), ('archiwum', 'Archiwum')], default='aktywny', max_length=20, verbose_name='status')),
                ('pracownik', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='grafiki', to='beauty_salon.pracownik')),
            ],
            options={
                'verbose_name': 'grafik',
                'verbose_name_plural': 'grafiki',
                'db_table': 'grafiki',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RaportPDF',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('typ', models.CharField(choices=[('lista_wizyt', 'Lista wizyt'), ('lista_klientow', 'Lista klientów'), ('oblozenie_pracownikow', 'Obłożenie pracowników'), ('top_uslugi', 'Najpopularniejsze usługi'), ('anulacje_noshow', 'Anulacje i no-show'), ('raport_finansowy', 'Raport finansowy')], db_index=True, max_length=30, verbose_name='typ')),
                ('tytul', models.CharField(max_length=200, verbose_name='tytuł')),
                ('sciezka_pliku', models.CharField(max_length=500, verbose_name='ścieżka pliku')),
                ('data_od', models.DateField(blank=True, null=True, verbose_name='data od')),
                ('data_do', models.DateField(blank=True, null=True, verbose_name='data do')),
                ('parametry', models.JSONField(blank=True, default=dict, verbose_name='parametry')),
                ('rozmiar_pliku', models.PositiveIntegerField(default=0, verbose_name='rozmiar pliku (B)')),
                ('wygenerowany_przez', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='raporty', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'raport PDF',
                'verbose_name_plural': 'raporty PDF',
                'db_table': 'raporty',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='StatystykaSnapshot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('okres', models.CharField(choices=[('dzienny', 'Dzienny'), ('tygodniowy', 'Tygodniowy'), ('miesieczny', 'Miesięczny')], max_length=20, verbose_name='okres')),
                ('data_od', models.DateField(db_index=True, verbose_name='data od')),
                ('data_do', models.DateField(verbose_name='data do')),
                ('liczba_wizyt_total', models.PositiveIntegerField(default=0, verbose_name='liczba wizyt (total)')),
                ('liczba_wizyt_zrealizowanych', models.PositiveIntegerField(default=0, verbose_name='liczba wizyt zrealizowanych')),
                ('liczba_anulacji', models.PositiveIntegerField(default=0, verbose_name='liczba anulacji')),
                ('liczba_noshow', models.PositiveIntegerField(default=0, verbose_name='liczba no-show')),
                ('przychod_total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='przychód total')),
                ('przychod_zaliczek', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=12, verbose_name='przychód z zaliczek')),
                ('liczba_nowych_klientow', models.PositiveIntegerField(default=0, verbose_name='liczba nowych klientów')),
                ('liczba_powracajacych_klientow', models.PositiveIntegerField(default=0, verbose_name='liczba powracających klientów')),
                ('srednie_oblozenie_pracownikow', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='średnie obłożenie pracowników %')),
                ('dodatkowe_metryki', models.JSONField(blank=True, default=dict, verbose_name='dodatkowe metryki')),
            ],
            options={
                'verbose_name': 'statystyka snapshot',
                'verbose_name_plural': 'statystyki snapshots',
                'db_table': 'statystyki_snapshots',
                'ordering': ['-data_od'],
                'indexes': [models.Index(fields=['okres', 'data_od'], name='statystyki__okres_764445_idx')],
                'unique_together': {('okres', 'data_od')},
            },
        ),
        migrations.CreateModel(
            name='Urlop',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('typ', models.CharField(choices=[('urlop', 'Urlop'), ('choroba', 'Choroba'), ('osobiste', 'Osobiste/Inne')], default='urlop', max_length=20, verbose_name='typ')),
                ('status', models.CharField(choices=[('oczekujacy', 'Oczekujący'), ('zatwierdzony', 'Zatwierdzony'), ('odrzucony', 'Odrzucony')], default='oczekujacy', max_length=20, verbose_name='status')),
                ('data_od', models.DateField(verbose_name='data od')),
                ('data_do', models.DateField(verbose_name='data do')),
                ('powod', models.TextField(blank=True, verbose_name='powód/opis')),
                ('data_zatwierdzenia', models.DateTimeField(blank=True, null=True, verbose_name='data zatwierdzenia')),
                ('pracownik', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='urlopy', to='beauty_salon.pracownik')),
                ('zatwierdzony_przez', models.ForeignKey(blank=True, limit_choices_to={'role': 'manager'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='zatwierdzone_urlopy', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'urlop/niedostępność',
                'verbose_name_plural': 'urlopy/niedostępności',
                'db_table': 'urlopy',
            },
        ),
        migrations.CreateModel(
            name='Usluga',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('nazwa', models.CharField(db_index=True, max_length=200, verbose_name='nazwa')),
                ('kategoria', models.CharField(db_index=True, max_length=100, verbose_name='kategoria')),
                ('opis', models.TextField(blank=True, verbose_name='opis')),
                ('cena', models.DecimalField(decimal_places=2, max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='cena')),
                ('czas_trwania', models.DurationField(verbose_name='czas trwania')),
                ('zdjecie_url', models.CharField(blank=True, max_length=500, verbose_name='zdjęcie URL')),
                ('publikowana', models.BooleanField(db_index=True, default=True, verbose_name='publikowana')),
                ('promocja', models.JSONField(blank=True, null=True, verbose_name='promocja')),
                ('liczba_rezerwacji', models.PositiveIntegerField(default=0, verbose_name='liczba rezerwacji')),
            ],
            options={
                'verbose_name': 'usługa',
                'verbose_name_plural': 'usługi',
                'db_table': 'uslugi',
                'ordering': ['kategoria', 'nazwa'],
                'indexes': [models.Index(fields=['kategoria', 'publikowana'], name='uslugi_kategor_47c268_idx'), models.Index(fields=['liczba_rezerwacji'], name='uslugi_liczba__38ba9d_idx')],
            },
        ),
        migrations.AddField(
            model_name='pracownik',
            name='kompetencje',
            field=models.ManyToManyField(blank=True, related_name='pracownicy', to='beauty_salon.usluga'),
        ),
        migrations.CreateModel(
            name='UstawieniaSystemowe',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('slot_minuty', models.PositiveIntegerField(default=30, validators=[django.core.validators.MinValueValidator(5), django.core.validators.MaxValueValidator(120)], verbose_name='slot minuty')),
                ('bufor_minuty', models.PositiveIntegerField(default=0, validators=[django.core.validators.MaxValueValidator(60)], verbose_name='bufor minuty')),
                ('polityka_zaliczek', models.JSONField(default=dict, help_text='{"wymagana": true, "procent": 20, "godziny_anulowania": 24}', verbose_name='polityka zaliczek')),
                ('harmonogram_powiadomien', models.JSONField(default=dict, help_text='{"potwierdzenie": "natychmiast", "przypomnienie_godziny": 24}', verbose_name='harmonogram powiadomień')),
                ('godziny_otwarcia', models.JSONField(default=dict, help_text='{"poniedzialek": {"start": "09:00", "end": "18:00"}}', verbose_name='godziny otwarcia')),
                ('nazwa_salonu', models.CharField(default='Beauty Salon', max_length=200, verbose_name='nazwa salonu')),
                ('adres', models.CharField(blank=True, max_length=300, verbose_name='adres')),
                ('telefon', models.CharField(blank=True, max_length=20, validators=[django.core.validators.RegexValidator('^\\+?1?\\d{9,15}$', "Numer telefonu musi być w formacie: '+999999999'. Do 15 cyfr.")], verbose_name='telefon')),
                ('email_kontaktowy', models.EmailField(blank=True, max_length=254, verbose_name='email kontaktowy')),
                ('stawka_vat_domyslna', models.DecimalField(decimal_places=2, default=Decimal('23.00'), max_digits=5, verbose_name='stawka VAT domyślna %')),
                ('tryb_konserwacji', models.BooleanField(default=False, verbose_name='tryb konserwacji')),
                ('komunikat_konserwacji', models.TextField(blank=True, verbose_name='komunikat konserwacji')),
                ('ostatnia_modyfikacja_przez', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modyfikacje_ustawien', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'ustawienia systemowe',
                'verbose_name_plural': 'ustawienia systemowe',
                'db_table': 'ustawienia',
            },
        ),
        migrations.CreateModel(
            name='Wizyta',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('status', models.CharField(choices=[('oczekujaca', 'Oczekująca'), ('potwierdzona', 'Potwierdzona'), ('w_trakcie', 'W trakcie'), ('zrealizowana', 'Zrealizowana'), ('odwolana', 'Odwołana'), ('no_show', 'No-show')], db_index=True, default='oczekujaca', max_length=20, verbose_name='status')),
                ('termin_start', models.DateTimeField(db_index=True, verbose_name='termin start')),
                ('termin_koniec', models.DateTimeField(verbose_name='termin koniec')),
                ('timespan', models.CharField(blank=True, help_text='Tymczasowy placeholder', max_length=255, null=True, verbose_name='zakres czasu')),
                ('kanal_rezerwacji', models.CharField(choices=[('web', 'Strona WWW'), ('telefon', 'Telefon'), ('osobiscie', 'Osobiście'), ('pracownik', 'Przez pracownika')], default='web', max_length=20, verbose_name='kanał rezerwacji')),
                ('notatki_klienta', models.TextField(blank=True, verbose_name='notatki klienta')),
                ('notatki_wewnetrzne', models.TextField(blank=True, verbose_name='notatki wewnętrzne')),
                ('data_anulowania', models.DateTimeField(blank=True, null=True, verbose_name='data anulowania')),
                ('powod_anulowania', models.TextField(blank=True, verbose_name='powód anulowania')),
                ('przypomnienie_wyslane', models.BooleanField(default=False, verbose_name='przypomnienie wysłane')),
                ('data_wyslania_przypomnienia', models.DateTimeField(blank=True, null=True)),
                ('anulowana_przez', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='anulowane_wizyty', to=settings.AUTH_USER_MODEL)),
                ('klient', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='wizyty', to='beauty_salon.klient')),
                ('pracownik', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='wizyty', to='beauty_salon.pracownik')),
                ('usluga', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='wizyty', to='beauty_salon.usluga')),
            ],
            options={
                'verbose_name': 'wizyta',
                'verbose_name_plural': 'wizyty',
                'db_table': 'wizyty',
                'ordering': ['-termin_start'],
            },
        ),
        migrations.CreateModel(
            name='Powiadomienie',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('typ', models.CharField(choices=[('potwierdzenie', 'Potwierdzenie rezerwacji'), ('przypomnienie', 'Przypomnienie o wizycie'), ('anulowanie', 'Anulowanie wizyty'), ('zmiana', 'Zmiana terminu'), ('promocja', 'Promocja')], max_length=20, verbose_name='typ')),
                ('kanal', models.CharField(choices=[('email', 'Email'), ('sms', 'SMS'), ('push', 'Push notification')], max_length=20, verbose_name='kanał')),
                ('status', models.CharField(choices=[('oczekujace', 'Oczekujące'), ('wyslane', 'Wysłane'), ('dostarczone', 'Dostarczone'), ('blad', 'Błąd')], db_index=True, default='oczekujace', max_length=20, verbose_name='status')),
                ('tresc', models.TextField(verbose_name='treść')),
                ('temat', models.CharField(blank=True, max_length=200, verbose_name='temat')),
                ('termin_wysylki', models.DateTimeField(db_index=True, verbose_name='termin wysyłki')),
                ('data_wyslania', models.DateTimeField(blank=True, null=True, verbose_name='data wysłania')),
                ('liczba_prob', models.PositiveIntegerField(default=0, verbose_name='liczba prób')),
                ('komunikat_bledu', models.TextField(blank=True, verbose_name='komunikat błędu')),
                ('klient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='powiadomienia', to='beauty_salon.klient')),
                ('wizyta', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='powiadomienia', to='beauty_salon.wizyta')),
            ],
            options={
                'verbose_name': 'powiadomienie',
                'verbose_name_plural': 'powiadomienia',
                'db_table': 'powiadomienia',
                'ordering': ['termin_wysylki'],
            },
        ),
        migrations.CreateModel(
            name='Platnosc',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('kwota', models.DecimalField(decimal_places=2, max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='kwota')),
                ('status', models.CharField(choices=[('oczekujaca', 'Oczekująca'), ('zaplacona', 'Zapłacona'), ('zwrocona', 'Zwrócona'), ('przepadla', 'Przepadła')], db_index=True, default='oczekujaca', max_length=20, verbose_name='status')),
                ('typ', models.CharField(choices=[('zaliczka', 'Zaliczka'), ('platnosc_pelna', 'Płatność pełna'), ('kara', 'Kara za no-show')], default='platnosc_pelna', max_length=20, verbose_name='typ')),
                ('metoda_platnosci', models.CharField(choices=[('gotowka', 'Gotówka'), ('karta', 'Karta'), ('przelew', 'Przelew'), ('online', 'Płatność online')], default='gotowka', max_length=20, verbose_name='metoda płatności')),
                ('data_platnosci', models.DateTimeField(blank=True, db_index=True, null=True, verbose_name='data płatności')),
                ('reference', models.CharField(blank=True, max_length=200, verbose_name='referencja')),
                ('wizyta', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='platnosci', to='beauty_salon.wizyta')),
            ],
            options={
                'verbose_name': 'płatność',
                'verbose_name_plural': 'płatności',
                'db_table': 'platnosci',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Notatka',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tresc', models.TextField(verbose_name='treść')),
                ('widoczna_dla_klienta', models.BooleanField(default=False, verbose_name='widoczna dla klienta')),
                ('autor', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notatki', to=settings.AUTH_USER_MODEL)),
                ('wizyta', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notatki', to='beauty_salon.wizyta')),
            ],
            options={
                'verbose_name': 'notatka',
                'verbose_name_plural': 'notatki',
                'db_table': 'notatki',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Faktura',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('numer', models.CharField(db_index=True, max_length=50, unique=True, verbose_name='numer faktury')),
                ('data_wystawienia', models.DateField(db_index=True, verbose_name='data wystawienia')),
                ('data_sprzedazy', models.DateField(verbose_name='data sprzedaży')),
                ('termin_platnosci', models.DateField(blank=True, null=True, verbose_name='termin płatności')),
                ('kwota_netto', models.DecimalField(decimal_places=2, max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='kwota netto')),
                ('stawka_vat', models.DecimalField(decimal_places=2, default=Decimal('23.00'), max_digits=5, verbose_name='stawka VAT %')),
                ('kwota_vat', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='kwota VAT')),
                ('kwota_brutto', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='kwota brutto')),
                ('zaplacona', models.BooleanField(db_index=True, default=False, verbose_name='zapłacona')),
                ('data_zaplaty', models.DateField(blank=True, null=True, verbose_name='data zapłaty')),
                ('plik_pdf', models.CharField(blank=True, max_length=500, verbose_name='plik PDF')),
                ('klient', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='faktury', to='beauty_salon.klient')),
                ('wizyta', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='faktury', to='beauty_salon.wizyta')),
            ],
            options={
                'verbose_name': 'faktura',
                'verbose_name_plural': 'faktury',
                'db_table': 'faktury',
                'ordering': ['-data_wystawienia', '-numer'],
            },
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['email', 'is_active'], name='users_email_a7cfd1_idx'),
        ),
        migrations.AddIndex(
            model_name='user',
            index=models.Index(fields=['role'], name='users_role_0ace22_idx'),
        ),
        migrations.AddIndex(
            model_name='klient',
            index=models.Index(fields=['email'], name='klienci_email_05ab1f_idx'),
        ),
        migrations.AddIndex(
            model_name='klient',
            index=models.Index(fields=['telefon'], name='klienci_telefon_dfe570_idx'),
        ),
        migrations.AddIndex(
            model_name='klient',
            index=models.Index(fields=['liczba_wizyt'], name='klienci_liczba__eda348_idx'),
        ),
        migrations.AddIndex(
            model_name='klient',
            index=models.Index(fields=['deleted_at'], name='klienci_deleted_f816a7_idx'),
        ),
        migrations.AddIndex(
            model_name='logentry',
            index=models.Index(fields=['typ', 'czas'], name='logi_typ_573dec_idx'),
        ),
        migrations.AddIndex(
            model_name='logentry',
            index=models.Index(fields=['uzytkownik', 'czas'], name='logi_uzytkow_67bd0b_idx'),
        ),
        migrations.AddIndex(
            model_name='logentry',
            index=models.Index(fields=['entity_type', 'entity_id'], name='logi_entity__dbec4f_idx'),
        ),
        migrations.AddIndex(
            model_name='material',
            index=models.Index(fields=['wlasciciel_prac', 'aktywny'], name='materialy_wlascic_e387c3_idx'),
        ),
        migrations.AddIndex(
            model_name='material',
            index=models.Index(fields=['typ', 'aktywny'], name='materialy_typ_176918_idx'),
        ),
        migrations.AddConstraint(
            model_name='urlop',
            constraint=models.UniqueConstraint(fields=('pracownik', 'data_od', 'data_do'), name='unique_employee_timeoff'),
        ),
        migrations.AddConstraint(
            model_name='urlop',
            constraint=models.CheckConstraint(check=models.Q(('data_do__gte', models.F('data_od'))), name='urlop_valid_dates'),
        ),
        migrations.AddIndex(
            model_name='pracownik',
            index=models.Index(fields=['aktywny', 'liczba_wizyt'], name='pracownicy_aktywny_3cadd9_idx'),
        ),
        migrations.AddIndex(
            model_name='wizyta',
            index=models.Index(fields=['pracownik', 'termin_start'], name='wizyty_pracown_a50457_idx'),
        ),
        migrations.AddIndex(
            model_name='wizyta',
            index=models.Index(fields=['klient', 'status'], name='wizyty_klient__9dd81f_idx'),
        ),
        migrations.AddIndex(
            model_name='wizyta',
            index=models.Index(fields=['status', 'termin_start'], name='wizyty_status_b69526_idx'),
        ),
        migrations.AddConstraint(
            model_name='wizyta',
            constraint=models.CheckConstraint(check=models.Q(('termin_koniec__gt', models.F('termin_start'))), name='wizyty_end_after_start'),
        ),
        migrations.AddIndex(
            model_name='powiadomienie',
            index=models.Index(fields=['status', 'termin_wysylki'], name='powiadomien_status_162fea_idx'),
        ),
        migrations.AddIndex(
            model_name='powiadomienie',
            index=models.Index(fields=['klient', 'typ'], name='powiadomien_klient__77a315_idx'),
        ),
        migrations.AddIndex(
            model_name='platnosc',
            index=models.Index(fields=['status', 'typ'], name='platnosci_status_8ea1b5_idx'),
        ),
        migrations.AddIndex(
            model_name='platnosc',
            index=models.Index(fields=['wizyta'], name='platnosci_wizyta__41915e_idx'),
        ),
        migrations.AddIndex(
            model_name='faktura',
            index=models.Index(fields=['klient', 'data_wystawienia'], name='faktury_klient__c6b0ad_idx'),
        ),
        migrations.AddIndex(
            model_name='faktura',
            index=models.Index(fields=['zaplacona', 'termin_platnosci'], name='faktury_zaplaco_c781ed_idx'),
        ),
    ]
